# Описание алгоритма

## Методы преобразования

Различие осени и лета на снимках — в цвете листвы: осень даёт красные, оранжевые, жёлтые тона, лето — зелёные. Достаточно перекрашивать только листву, не трогая небо, стволы и землю.

Работа идёт в модели **HSV**. Оттенок H в OpenCV от 0 до 180: красный у 0 и 180, жёлтый около 25–35, зелёный 35–85. Осенняя листва лежит в диапазонах 0–50 и 150–180, летняя — в 35–85. Каналы S и V нужны только для маски: пиксели с низкой насыщенностью или слишком тёмные не считаем листвой и не меняем (так не трогаем небо, тени, стволы).

**Осень → лето.** Строим маску: H в «тёплом» диапазоне (0–50 или 150–180) и S, V выше порогов (в коде 25 и 30). Для этих пикселей по таблице (LUT) заменяем H на зелёный диапазон (40–80). Маску слегка размываем по Гауссу и смешиваем новый H со старым по весу маски — границы выходят мягче.

**Лето → осень.** Маска по зелёному H (30–95), те же пороги S и V. LUT переводит зелёный H в оранжево-красный (8–28). Смешивание по маске такое же.

Итого: переход в HSV → маска листвы по H, S, V → замена H по LUT только по маске → обратно в BGR.

## Структура программы

Схема: загружаем Photo1 и Photo2. Для Summer.jpg: Photo1 → BGR→HSV → маска осенней листвы → LUT (осень→зелень) → смешивание H по маске → HSV→BGR → сохранение. Для Autumn.jpg: Photo2 → то же с маской зелёной листвы и LUT зелень→осень.

В `convert_seasons.py`:

- `_build_hue_map_autumn_to_summer()` и `_build_hue_map_summer_to_autumn()` — таблицы отображения H.
- `_foliage_mask(hsv, hue_lo, hue_hi, sat_min, val_min)` — маска по диапазону H и порогам S, V, плюс размытие маски.
- `apply_season_transform(hsv, to_summer)` — выбор LUT и маски, применение LUT к H, смешивание по маске; S и V не трогаем.
- `autumn_to_summer(bgr)` и `summer_to_autumn(bgr)` — обёртки: BGR→HSV → transform → HSV→BGR.
- `main()` — аргументы (каталог входа и вывода), загрузка, вызов двух преобразований, запись Summer.jpg и Autumn.jpg.

Зависимости: OpenCV, NumPy. Запуск: `python convert_seasons.py [input_dir] [-o output_dir]`. По умолчанию вход и выход — текущий каталог.

## Достоинства и недостатки

Плюсы: простая схема, один канал H и таблица, без обучения; быстрая работа; маска по S и V уменьшает заливку неба и стволов; пороги и диапазоны H при желании можно вынести в настройки; каждое фото обрабатывается отдельно, соответствие между Photo1 и Photo2 не нужно.

Минусы: меняется только цвет листвы, освещение и геометрия те же; жёстко заданные диапазоны H могут давать артефакты при нестандартной съёмке или других породах деревьев; маска только по цвету — зелёная трава и зелёные объекты тоже перекрасятся; нет учёта локальной освещённости, листва может выглядеть однородной; при плохой насыщенности или необычном цветовом профиле результат может быть хуже.
